<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ãƒ–ãƒ­ãƒƒã‚¯å´©ã— - ãƒ†ã‚¹ãƒˆ</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f0f0f0;
    }
    .test-section {
      background: white;
      margin: 10px 0;
      padding: 15px;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .test-result {
      padding: 10px;
      margin: 5px 0;
      border-radius: 3px;
    }
    .pass {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    .fail {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    .info {
      background: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
    }
    button {
      background: #007bff;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 3px;
      cursor: pointer;
      margin: 5px;
    }
    button:hover {
      background: #0056b3;
    }
    #gameCanvas {
      border: 1px solid #ccc;
      margin: 10px 0;
    }
  </style>
</head>
<body>
  <h1>ãƒ–ãƒ­ãƒƒã‚¯å´©ã— - æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</h1>
  
  <div class="test-section">
    <h2>åŸºæœ¬æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</h2>
    <button onclick="testBasicFunctions()">åŸºæœ¬æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆ</button>
    <div id="basic-results"></div>
  </div>

  <div class="test-section">
    <h2>ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ãƒ†ã‚¹ãƒˆ</h2>
    <button onclick="testPowerUps()">ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ã‚’ãƒ†ã‚¹ãƒˆ</button>
    <div id="powerup-results"></div>
  </div>

  <div class="test-section">
    <h2>æ–°ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ãƒ†ã‚¹ãƒˆ</h2>
    <button onclick="testNewPowerUps()">æ–°ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ã‚’ãƒ†ã‚¹ãƒˆ</button>
    <div id="new-powerup-results"></div>
  </div>

  <div class="test-section">
    <h2>ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ</h2>
    <button onclick="testAnimations()">ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ†ã‚¹ãƒˆ</button>
    <div id="animation-results"></div>
  </div>

  <div class="test-section">
    <h2>ã‚²ãƒ¼ãƒ çŠ¶æ…‹ãƒ†ã‚¹ãƒˆ</h2>
    <button onclick="testGameStates()">ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã‚’ãƒ†ã‚¹ãƒˆ</button>
    <div id="state-results"></div>
  </div>

  <div class="test-section">
    <h2>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ</h2>
    <button onclick="testPerformance()">ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ãƒ†ã‚¹ãƒˆ</button>
    <div id="performance-results"></div>
  </div>

  <canvas id="gameCanvas" width="480" height="640"></canvas>

  <script src="game.js"></script>
  <script>
    // ãƒ†ã‚¹ãƒˆç”¨ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
    let testResults = [];

    function addResult(containerId, message, type = 'info') {
      const container = document.getElementById(containerId);
      const div = document.createElement('div');
      div.className = `test-result ${type}`;
      div.textContent = message;
      container.appendChild(div);
    }

    function clearResults(containerId) {
      document.getElementById(containerId).innerHTML = '';
    }

    function testBasicFunctions() {
      clearResults('basic-results');
      
      try {
        // Canvas ãƒ†ã‚¹ãƒˆ
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        if (ctx) {
          addResult('basic-results', 'âœ… Canvas ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå–å¾—æˆåŠŸ', 'pass');
        } else {
          addResult('basic-results', 'âŒ Canvas ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå–å¾—å¤±æ•—', 'fail');
        }

        // ã‚²ãƒ¼ãƒ å¤‰æ•°ãƒ†ã‚¹ãƒˆ
        if (typeof WIDTH !== 'undefined' && WIDTH === 480) {
          addResult('basic-results', 'âœ… ã‚²ãƒ¼ãƒ å¹…è¨­å®šæ­£å¸¸', 'pass');
        } else {
          addResult('basic-results', 'âŒ ã‚²ãƒ¼ãƒ å¹…è¨­å®šç•°å¸¸', 'fail');
        }

        if (typeof HEIGHT !== 'undefined' && HEIGHT === 640) {
          addResult('basic-results', 'âœ… ã‚²ãƒ¼ãƒ é«˜ã•è¨­å®šæ­£å¸¸', 'pass');
        } else {
          addResult('basic-results', 'âŒ ã‚²ãƒ¼ãƒ é«˜ã•è¨­å®šç•°å¸¸', 'fail');
        }

        // ãƒ‘ãƒ‰ãƒ«ãƒ†ã‚¹ãƒˆ
        if (paddle && typeof paddle.x === 'number' && typeof paddle.y === 'number') {
          addResult('basic-results', 'âœ… ãƒ‘ãƒ‰ãƒ«åˆæœŸåŒ–æ­£å¸¸', 'pass');
        } else {
          addResult('basic-results', 'âŒ ãƒ‘ãƒ‰ãƒ«åˆæœŸåŒ–ç•°å¸¸', 'fail');
        }

        // ãƒœãƒ¼ãƒ«ãƒ†ã‚¹ãƒˆ
        if (ball && typeof ball.x === 'number' && typeof ball.y === 'number') {
          addResult('basic-results', 'âœ… ãƒœãƒ¼ãƒ«åˆæœŸåŒ–æ­£å¸¸', 'pass');
        } else {
          addResult('basic-results', 'âŒ ãƒœãƒ¼ãƒ«åˆæœŸåŒ–ç•°å¸¸', 'fail');
        }

        // ãƒ–ãƒ­ãƒƒã‚¯ç”Ÿæˆãƒ†ã‚¹ãƒˆ
        if (typeof generateStage === 'function') {
          addResult('basic-results', 'âœ… ã‚¹ãƒ†ãƒ¼ã‚¸ç”Ÿæˆé–¢æ•°å­˜åœ¨', 'pass');
        } else {
          addResult('basic-results', 'âŒ ã‚¹ãƒ†ãƒ¼ã‚¸ç”Ÿæˆé–¢æ•°ä¸å­˜åœ¨', 'fail');
        }

      } catch (error) {
        addResult('basic-results', `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'fail');
      }
    }

    function testPowerUps() {
      clearResults('powerup-results');
      
      try {
        // ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—é–¢æ•°ãƒ†ã‚¹ãƒˆ
        if (typeof spawnPowerUp === 'function') {
          addResult('powerup-results', 'âœ… ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ç”Ÿæˆé–¢æ•°å­˜åœ¨', 'pass');
        } else {
          addResult('powerup-results', 'âŒ ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ç”Ÿæˆé–¢æ•°ä¸å­˜åœ¨', 'fail');
        }

        if (typeof applyPowerUp === 'function') {
          addResult('powerup-results', 'âœ… ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—é©ç”¨é–¢æ•°å­˜åœ¨', 'pass');
        } else {
          addResult('powerup-results', 'âŒ ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—é©ç”¨é–¢æ•°ä¸å­˜åœ¨', 'fail');
        }

        // ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—é…åˆ—ãƒ†ã‚¹ãƒˆ
        if (Array.isArray(powerUps)) {
          addResult('powerup-results', 'âœ… ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—é…åˆ—åˆæœŸåŒ–æ­£å¸¸', 'pass');
        } else {
          addResult('powerup-results', 'âŒ ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—é…åˆ—åˆæœŸåŒ–ç•°å¸¸', 'fail');
        }

        // ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ç”Ÿæˆãƒ†ã‚¹ãƒˆ
        const initialCount = powerUps.length;
        spawnPowerUp(100, 100);
        if (powerUps.length > initialCount) {
          addResult('powerup-results', 'âœ… ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ç”ŸæˆæˆåŠŸ', 'pass');
        } else {
          addResult('powerup-results', 'âŒ ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ç”Ÿæˆå¤±æ•—', 'fail');
        }

        // ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—é©ç”¨ãƒ†ã‚¹ãƒˆ
        const initialScore = score;
        applyPowerUp('score2x');
        if (score > initialScore) {
          addResult('powerup-results', 'âœ… ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—é©ç”¨æˆåŠŸ', 'pass');
        } else {
          addResult('powerup-results', 'âŒ ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—é©ç”¨å¤±æ•—', 'fail');
        }
        
        // æ–°ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ã®ç¨®é¡ãƒã‚§ãƒƒã‚¯
        const powerUpTypes = ['expand', 'multi', 'pierce', 'slow', 'score2x', 'shield', 'laser', 'bomb', 'life', 'speedup'];
        const generatedTypes = powerUps.map(pu => pu.type);
        const hasAllTypes = powerUpTypes.every(type => generatedTypes.includes(type));
        
        if (hasAllTypes) {
          addResult('powerup-results', 'âœ… å…¨ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ç¨®é¡ãŒåˆ©ç”¨å¯èƒ½', 'pass');
        } else {
          addResult('powerup-results', 'âŒ ä¸€éƒ¨ã®ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ç¨®é¡ãŒä¸è¶³', 'fail');
        }

      } catch (error) {
        addResult('powerup-results', `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'fail');
      }
    }

    function testAnimations() {
      clearResults('animation-results');
      
      try {
        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å¤‰æ•°ãƒ†ã‚¹ãƒˆ
        if (typeof animationFrame === 'number') {
          addResult('animation-results', 'âœ… ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ãƒ¬ãƒ¼ãƒ å¤‰æ•°å­˜åœ¨', 'pass');
        } else {
          addResult('animation-results', 'âŒ ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ãƒ¬ãƒ¼ãƒ å¤‰æ•°ä¸å­˜åœ¨', 'fail');
        }

        if (typeof backgroundOffset === 'number') {
          addResult('animation-results', 'âœ… èƒŒæ™¯ã‚ªãƒ•ã‚»ãƒƒãƒˆå¤‰æ•°å­˜åœ¨', 'pass');
        } else {
          addResult('animation-results', 'âŒ èƒŒæ™¯ã‚ªãƒ•ã‚»ãƒƒãƒˆå¤‰æ•°ä¸å­˜åœ¨', 'fail');
        }

        // ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ
        if (Array.isArray(particles)) {
          addResult('animation-results', 'âœ… ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«é…åˆ—åˆæœŸåŒ–æ­£å¸¸', 'pass');
        } else {
          addResult('animation-results', 'âŒ ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«é…åˆ—åˆæœŸåŒ–ç•°å¸¸', 'fail');
        }

        // ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ç”Ÿæˆãƒ†ã‚¹ãƒˆ
        if (typeof createParticleExplosion === 'function') {
          addResult('animation-results', 'âœ… ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«çˆ†ç™ºé–¢æ•°å­˜åœ¨', 'pass');
        } else {
          addResult('animation-results', 'âŒ ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«çˆ†ç™ºé–¢æ•°ä¸å­˜åœ¨', 'fail');
        }

        // ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ç”Ÿæˆãƒ†ã‚¹ãƒˆ
        const initialParticleCount = particles.length;
        createParticleExplosion(200, 200, '#ff0000');
        if (particles.length > initialParticleCount) {
          addResult('animation-results', 'âœ… ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ç”ŸæˆæˆåŠŸ', 'pass');
        } else {
          addResult('animation-results', 'âŒ ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ç”Ÿæˆå¤±æ•—', 'fail');
        }

        // æç”»é–¢æ•°ãƒ†ã‚¹ãƒˆ
        const drawFunctions = ['drawBackground', 'drawParticles', 'drawEffects'];
        drawFunctions.forEach(funcName => {
          if (typeof window[funcName] === 'function') {
            addResult('animation-results', `âœ… ${funcName}é–¢æ•°å­˜åœ¨`, 'pass');
          } else {
            addResult('animation-results', `âŒ ${funcName}é–¢æ•°ä¸å­˜åœ¨`, 'fail');
          }
        });

      } catch (error) {
        addResult('animation-results', `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'fail');
      }
    }

    function testGameStates() {
      clearResults('state-results');
      
      try {
        // ã‚²ãƒ¼ãƒ çŠ¶æ…‹ãƒ†ã‚¹ãƒˆ
        if (typeof gameState === 'string') {
          addResult('state-results', 'âœ… ã‚²ãƒ¼ãƒ çŠ¶æ…‹å¤‰æ•°å­˜åœ¨', 'pass');
        } else {
          addResult('state-results', 'âŒ ã‚²ãƒ¼ãƒ çŠ¶æ…‹å¤‰æ•°ä¸å­˜åœ¨', 'fail');
        }

        // ã‚¹ã‚³ã‚¢ãƒ†ã‚¹ãƒˆ
        if (typeof score === 'number') {
          addResult('state-results', 'âœ… ã‚¹ã‚³ã‚¢å¤‰æ•°å­˜åœ¨', 'pass');
        } else {
          addResult('state-results', 'âŒ ã‚¹ã‚³ã‚¢å¤‰æ•°ä¸å­˜åœ¨', 'fail');
        }

        // ãƒªã‚»ãƒƒãƒˆé–¢æ•°ãƒ†ã‚¹ãƒˆ
        if (typeof resetGame === 'function') {
          addResult('state-results', 'âœ… ãƒªã‚»ãƒƒãƒˆé–¢æ•°å­˜åœ¨', 'pass');
        } else {
          addResult('state-results', 'âŒ ãƒªã‚»ãƒƒãƒˆé–¢æ•°ä¸å­˜åœ¨', 'fail');
        }

        // ã‚²ãƒ¼ãƒ ãƒ«ãƒ¼ãƒ—é–¢æ•°ãƒ†ã‚¹ãƒˆ
        if (typeof gameLoop === 'function') {
          addResult('state-results', 'âœ… ã‚²ãƒ¼ãƒ ãƒ«ãƒ¼ãƒ—é–¢æ•°å­˜åœ¨', 'pass');
        } else {
          addResult('state-results', 'âŒ ã‚²ãƒ¼ãƒ ãƒ«ãƒ¼ãƒ—é–¢æ•°ä¸å­˜åœ¨', 'fail');
        }

        // ã‚­ãƒ¼å…¥åŠ›ãƒ†ã‚¹ãƒˆ
        if (typeof leftPressed === 'boolean' && typeof rightPressed === 'boolean') {
          addResult('state-results', 'âœ… ã‚­ãƒ¼å…¥åŠ›å¤‰æ•°å­˜åœ¨', 'pass');
        } else {
          addResult('state-results', 'âŒ ã‚­ãƒ¼å…¥åŠ›å¤‰æ•°ä¸å­˜åœ¨', 'fail');
        }

      } catch (error) {
        addResult('state-results', `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'fail');
      }
    }

    function testPerformance() {
      clearResults('performance-results');
      
      try {
        const startTime = performance.now();
        
        // æç”»é–¢æ•°ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
        for (let i = 0; i < 100; i++) {
          draw();
        }
        
        const endTime = performance.now();
        const duration = endTime - startTime;
        
        if (duration < 1000) { // 1ç§’ä»¥å†…
          addResult('performance-results', `âœ… æç”»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è‰¯å¥½ (${duration.toFixed(2)}ms)`, 'pass');
        } else {
          addResult('performance-results', `âš ï¸ æç”»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹é…ã„ (${duration.toFixed(2)}ms)`, 'fail');
        }

        // ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãƒ†ã‚¹ãƒˆ
        const initialMemory = performance.memory ? performance.memory.usedJSHeapSize : 0;
        
        // å¤§é‡ã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ç”Ÿæˆãƒ†ã‚¹ãƒˆ
        for (let i = 0; i < 100; i++) {
          createParticleExplosion(Math.random() * WIDTH, Math.random() * HEIGHT, '#ff0000');
        }
        
        const finalMemory = performance.memory ? performance.memory.usedJSHeapSize : 0;
        const memoryIncrease = finalMemory - initialMemory;
        
        if (memoryIncrease < 1000000) { // 1MBä»¥å†…
          addResult('performance-results', `âœ… ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡è‰¯å¥½ (${(memoryIncrease / 1024).toFixed(2)}KBå¢—åŠ )`, 'pass');
        } else {
          addResult('performance-results', `âš ï¸ ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡å¤šã„ (${(memoryIncrease / 1024).toFixed(2)}KBå¢—åŠ )`, 'fail');
        }

        // ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¬ãƒ¼ãƒˆãƒ†ã‚¹ãƒˆ
        let frameCount = 0;
        const testDuration = 1000; // 1ç§’
        const startFrameTest = performance.now();
        
        function frameTest() {
          frameCount++;
          if (performance.now() - startFrameTest < testDuration) {
            requestAnimationFrame(frameTest);
          } else {
            const fps = frameCount;
            if (fps > 30) {
              addResult('performance-results', `âœ… ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¬ãƒ¼ãƒˆè‰¯å¥½ (${fps} FPS)`, 'pass');
            } else {
              addResult('performance-results', `âš ï¸ ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¬ãƒ¼ãƒˆä½ã„ (${fps} FPS)`, 'fail');
            }
          }
        }
        
        requestAnimationFrame(frameTest);

      } catch (error) {
        addResult('performance-results', `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'fail');
      }
    }

    function testNewPowerUps() {
      clearResults('new-powerup-results');
      
      try {
        addResult('new-powerup-results', 'ğŸ” æ–°ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹...', 'info');
        
        // æ–°ã—ã„ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—å¤‰æ•°ã®å­˜åœ¨ç¢ºèª
        if (typeof lives === 'number') {
          addResult('new-powerup-results', 'âœ… ãƒ©ã‚¤ãƒ•ã‚·ã‚¹ãƒ†ãƒ å­˜åœ¨', 'pass');
        } else {
          addResult('new-powerup-results', 'âŒ ãƒ©ã‚¤ãƒ•ã‚·ã‚¹ãƒ†ãƒ ä¸å­˜åœ¨', 'fail');
        }
        
        if (typeof maxLives === 'number') {
          addResult('new-powerup-results', 'âœ… æœ€å¤§ãƒ©ã‚¤ãƒ•å¤‰æ•°å­˜åœ¨', 'pass');
        } else {
          addResult('new-powerup-results', 'âŒ æœ€å¤§ãƒ©ã‚¤ãƒ•å¤‰æ•°ä¸å­˜åœ¨', 'fail');
        }
        
        if (Array.isArray(lasers)) {
          addResult('new-powerup-results', 'âœ… ãƒ¬ãƒ¼ã‚¶ãƒ¼é…åˆ—å­˜åœ¨', 'pass');
        } else {
          addResult('new-powerup-results', 'âŒ ãƒ¬ãƒ¼ã‚¶ãƒ¼é…åˆ—ä¸å­˜åœ¨', 'fail');
        }
        
        if (typeof laserCooldown === 'number') {
          addResult('new-powerup-results', 'âœ… ãƒ¬ãƒ¼ã‚¶ãƒ¼ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³å­˜åœ¨', 'pass');
        } else {
          addResult('new-powerup-results', 'âŒ ãƒ¬ãƒ¼ã‚¶ãƒ¼ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ä¸å­˜åœ¨', 'fail');
        }
        
        // ãƒ‘ãƒ‰ãƒ«ã®ã‚·ãƒ¼ãƒ«ãƒ‰æ©Ÿèƒ½ç¢ºèª
        if (paddle.shield !== undefined) {
          addResult('new-powerup-results', 'âœ… ãƒ‘ãƒ‰ãƒ«ã‚·ãƒ¼ãƒ«ãƒ‰æ©Ÿèƒ½å­˜åœ¨', 'pass');
        } else {
          addResult('new-powerup-results', 'âŒ ãƒ‘ãƒ‰ãƒ«ã‚·ãƒ¼ãƒ«ãƒ‰æ©Ÿèƒ½ä¸å­˜åœ¨', 'fail');
        }
        
        if (paddle.shieldTimer !== undefined) {
          addResult('new-powerup-results', 'âœ… ã‚·ãƒ¼ãƒ«ãƒ‰ã‚¿ã‚¤ãƒãƒ¼å­˜åœ¨', 'pass');
        } else {
          addResult('new-powerup-results', 'âŒ ã‚·ãƒ¼ãƒ«ãƒ‰ã‚¿ã‚¤ãƒãƒ¼ä¸å­˜åœ¨', 'fail');
        }
        
        // æ–°ã—ã„ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ã®ç”Ÿæˆãƒ†ã‚¹ãƒˆ
        const initialPowerUpCount = powerUps.length;
        spawnPowerUp(100, 100);
        
        // æ–°ã—ã„ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ãŒç”Ÿæˆã•ã‚ŒãŸã‹ãƒã‚§ãƒƒã‚¯
        const newPowerUps = powerUps.filter(pu => 
          ['shield', 'laser', 'bomb', 'life', 'speedup'].includes(pu.type)
        );
        
        if (newPowerUps.length > 0) {
          addResult('new-powerup-results', `âœ… æ–°ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ç”ŸæˆæˆåŠŸ (${newPowerUps.length}å€‹)`, 'pass');
        } else {
          addResult('new-powerup-results', 'âŒ æ–°ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ç”Ÿæˆå¤±æ•—', 'fail');
        }
        
        // å„æ–°ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ã®é©ç”¨ãƒ†ã‚¹ãƒˆ
        const testPowerUps = ['shield', 'laser', 'bomb', 'life', 'speedup'];
        testPowerUps.forEach(type => {
          try {
            const initialLives = lives;
            const initialLaserCooldown = laserCooldown;
            const initialShield = paddle.shield;
            
            applyPowerUp(type);
            
            // åŠ¹æœãŒé©ç”¨ã•ã‚ŒãŸã‹ãƒã‚§ãƒƒã‚¯
            let effectApplied = false;
            switch (type) {
              case 'shield':
                effectApplied = paddle.shield === true;
                break;
              case 'laser':
                effectApplied = laserCooldown > 0;
                break;
              case 'bomb':
                effectApplied = blocks.length === 0;
                break;
              case 'life':
                effectApplied = lives > initialLives;
                break;
              case 'speedup':
                effectApplied = balls.some(ball => ball.dx > 4 || ball.dy > 4);
                break;
            }
            
            if (effectApplied) {
              addResult('new-powerup-results', `âœ… ${type}ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—é©ç”¨æˆåŠŸ`, 'pass');
            } else {
              addResult('new-powerup-results', `âŒ ${type}ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—é©ç”¨å¤±æ•—`, 'fail');
            }
            
          } catch (error) {
            addResult('new-powerup-results', `âŒ ${type}ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'fail');
          }
        });
        
        addResult('new-powerup-results', 'ğŸ‰ æ–°ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ãƒ†ã‚¹ãƒˆå®Œäº†ï¼', 'info');
        
      } catch (error) {
        addResult('new-powerup-results', `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'fail');
      }
    }

    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®è‡ªå‹•ãƒ†ã‚¹ãƒˆ
    window.addEventListener('load', () => {
      setTimeout(() => {
        addResult('basic-results', 'â„¹ï¸ ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†ã€‚å„ãƒ†ã‚¹ãƒˆãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚', 'info');
      }, 1000);
    });
  </script>
</body>
</html> 